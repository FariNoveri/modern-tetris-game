<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tetris Modern - Main Menu</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .menu-container {
      text-align: center;
      background: #222;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
    }
    .menu-container h1 {
      font-size: 3rem;
      margin-bottom: 30px;
    }
    .menu-button {
      display: block;
      width: 200px;
      margin: 15px auto;
      padding: 12px;
      font-size: 1.1rem;
      background: #444;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .menu-button:hover {
      background: #666;
    }
    .settings, .leaderboard {
      display: none;
      margin-top: 20px;
      text-align: left;
    }
    .back-button {
      margin-top: 20px;
      color: #ccc;
      text-decoration: underline;
      cursor: pointer;
    }
    #volumeSlider {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="menu-container" id="mainMenu">
    <h1>Tetris Modern</h1>
    <input type="text" id="playerName" placeholder="Enter your name" />
    <button class="menu-button" onclick="startGame()">‚ñ∂ Play</button>
    <button class="menu-button" onclick="toggleLeaderboard()">üèÜ Leaderboard</button>
    <button class="menu-button" onclick="toggleSettings()">‚öô Settings</button>
  </div>

  <!-- Leaderboard Panel -->
  <div class="menu-container leaderboard" id="leaderboardPanel">
    <h2>Top 10 Leaderboard</h2>
    <ol id="leaderboardList"></ol>
    <p id="playerRankInfo"></p>
    <div class="back-button" onclick="backToMain()">‚Üê Back</div>
  </div>

  <!-- Settings Panel -->
  <div class="menu-container settings" id="settingsPanel">
    <h2>Settings</h2>
    <label>Music Volume</label>
    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" />
    <p><strong>Keybinds:</strong><br/>
      ‚¨Ö Move Left<br/>
      ‚û° Move Right<br/>
      ‚¨á Soft Drop<br/>
      ‚¨Ü Rotate<br/>
      Space = Hard Drop<br/>
      P = Pause
    </p>
    <div class="back-button" onclick="backToMain()">‚Üê Back</div>
  </div>

  <script>
    function startGame() {
      const name = document.getElementById("playerName").value.trim();
      if (!name) {
        alert("Please enter your name.");
        return;
      }
      localStorage.setItem("playerName", name);
      window.location.href = "index.html";
    }

    function toggleLeaderboard() {
      document.getElementById("mainMenu").style.display = "none";
      document.getElementById("leaderboardPanel").style.display = "block";
      loadLeaderboard();
    }

    function toggleSettings() {
      document.getElementById("mainMenu").style.display = "none";
      document.getElementById("settingsPanel").style.display = "block";
      document.getElementById("volumeSlider").value = localStorage.getItem("musicVolume") || 0.5;
    }

    function backToMain() {
      document.getElementById("leaderboardPanel").style.display = "none";
      document.getElementById("settingsPanel").style.display = "none";
      document.getElementById("mainMenu").style.display = "block";
    }

    function loadLeaderboard() {
      const leaderboard = JSON.parse(localStorage.getItem("leaderboardData") || "[]");
      const playerName = localStorage.getItem("playerName");
      const list = document.getElementById("leaderboardList");
      const playerRankInfo = document.getElementById("playerRankInfo");

      list.innerHTML = "";
      let found = false;

      leaderboard.sort((a, b) => b.score - a.score).slice(0, 10).forEach((entry, index) => {
        const li = document.createElement("li");
        li.textContent = `${entry.name} - ${entry.score}`;
        list.appendChild(li);
      });

      leaderboard.forEach((entry, index) => {
        if (entry.name === playerName && index >= 10) {
          playerRankInfo.innerHTML = `<span style="color:yellow">You are ranked #${index + 1} - ${entry.score} pts</span>`;
          found = true;
        }
      });

      if (!found) playerRankInfo.textContent = "";
    }

    document.getElementById("volumeSlider").addEventListener("input", e => {
      localStorage.setItem("musicVolume", e.target.value);
    });

    // Pre-fill name if exists
    window.onload = () => {
      const savedName = localStorage.getItem("playerName");
      if (savedName) document.getElementById("playerName").value = savedName;
    };
  </script>
</body>
</html>
